#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Tue Feb 12 13:11:36 2019

@author: kazuki.onodera
"""

import numpy as np
import pandas as pd
import utils

tr = pd.read_feather('../data/train.f')
y_train = utils.load_target()['HasDetections']

te = pd.read_feather('../data/test.f')

tr_dt = pd.read_feather('../data/train_datetime.f')

te_dt = pd.read_feather('../data/test_datetime.f')

# =============================================================================
# 
# =============================================================================


tmp = pd.DataFrame()
tmp['AvSigVersion'] = tr.AvSigVersion.append( te.AvSigVersion )
tmp['AvSigVersion_dt'] = tr_dt.AvSigVersion.append( te_dt.AvSigVersion )
tmp.reset_index(drop=True, inplace=True)

tmp['AvSigVersion_v'] = tmp['AvSigVersion'].map(lambda x: '.'.join(x.split('.')[:2]))

tmp['avsig-m-avsig_v'] = (tmp['AvSigVersion_dt'] - tmp.groupby('AvSigVersion_v').AvSigVersion_dt.transform(min)).dt.seconds


tmp['y'] = np.nan
tmp.loc[:y_train.shape[0], 'y'] = y_train



















