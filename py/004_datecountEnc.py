#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Thu Jan 31 21:03:02 2019

@author: Kazuki
"""

import numpy as np
import pandas as pd
import os
import utils

PREF = ''




tr = pd.read_feather('../data/train.f')

te = pd.read_feather('../data/test.f')

#tr_f = pd.DataFrame(index=tr.index)
#te_f = pd.DataFrame(index=te.index)

# AS timestamp
datedictAS = np.load('../external/AvSigVersionTimestamps.npy')[()]
tr['AvSigVersion'] = tr['AvSigVersion'].map(datedictAS)
te['AvSigVersion'] = te['AvSigVersion'].map(datedictAS)




tr.sort_values('AvSigVersion', inplace=True)

tr.groupby(['AvSigVersion', 'EngineVersion']).size()
tr.groupby(['AvSigVersion', 'EngineVersion']).agg({'HasDetections': ['count', 'mean']})




# =============================================================================
# main
# =============================================================================
if __name__ == "__main__":
    utils.start(__file__)
    
    
    
    utils.end(__file__)

